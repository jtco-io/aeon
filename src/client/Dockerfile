ARG IMAGE=node:carbon
FROM $IMAGE

ARG FRONTEND_HOST=0.0.0.0
ARG FRONTEND_PORT=8080

ARG BACKEND_HOST=0.0.0.0
ARG BACKEND_PORT=8081
ARG PUBLIC_PATH=/static/

ENV INSTALL_PATH=/client
WORKDIR $INSTALL_PATH

COPY ./package.json $INSTALL_PATH/package.json
COPY ./yarn.lock $INSTALL_PATH/yarn.lock
RUN yarn install

COPY . $INSTALL_PATH

RUN yarn run build

EXPOSE $FRONTEND_PORT
ENTRYPOINT ["yarn"]
CMD ["run", "prod:start"]
